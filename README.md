# slurm-ansible

## Данный "проект" - это решение задачи Devops Upgrade, Комфорт. Поток 8 ( https://edu.slurm.io/courses/devops_upgrade_comfort8/units/6218/lessons/24525/steps/81939 )

Недочеты :

0. плейбук жестко привязан к ОС CentOS 7.9 .

1. согласно задания nginx роль должна была быть из ansible-galaxy :
    - решил сделать свою , т.к. нужно больше практики в написании ролей и тасок ;
    - ИБ не пропустило бы на текущй работе использование непроверенной роли ;
    - все роли найденные в git были или избыточны ( для всех ОС сразу ) или примитивными ( подключаем epel и ставим ) ;
    - также в ролях nginx не было открытие портов ( а нужно ли это , вопрос , а у меня есть =P ) .

2. роль postgre не идемпотентна :
    - при повторном запуске при уже существующей БД и pg_hba.conf таска не может подцепиться к БД ( за счет pg_hba.conf изменена возможность подключения к БД ) ;
    - попробовать написать таску проверки существования БД и обработку создания БД запихать в блок , если нет то создаем если есть пропускаем блок ( для тестого задания не критично , если будет время можно сделать ) .
  
3. отключаю SELinux и ребутаю ВМ , что не очень хорошо с точки зрения ИБ .

4. вижу что можно улучшить :
   - есть что вынести в переменные ;
   - есть что вынести в хэндлеры ( рестарты сервисов ) .

5. предполагаю , что бекам на весь плейбук не очень хорошая идея с точки зрения ИБ , тут нужен подход как с иптаблезом , закрываем все , разрешаем только что нужно , также и с бекамом , применять только в тех тасках или блоках где это необходимо .

## Посмотреть выполнение плейбука можно тут

https://www.youtube.com/watch?v=PqNSA4OGp4c
